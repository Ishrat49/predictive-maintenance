<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vehicle Health Dashboard</title>

    <!-- Bootstrap CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <style>
        body {
            background-color: #f4f6f9;
        }
        .card {
            margin-top: 20px;
        }
        .risk-high {
            color: red;
            font-weight: bold;
        }
        .risk-medium {
            color: orange;
            font-weight: bold;
        }
        .risk-low {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <h2 class="mt-4">üöó Vehicle Health Dashboard</h2>

    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Vehicle Status</h5>

            <p><strong>Vehicle ID:</strong> <span id="vehicleId">--</span></p>
            <p><strong>Health Score:</strong> <span id="healthScore">--</span></p>
            <p><strong>Risk Level:</strong> <span id="riskLevel">--</span></p>
            <p><strong>Predicted Issue:</strong> <span id="issue">--</span></p>
            <p><strong>Agent Action:</strong> <span id="agentAction">--</span></p>
        </div>
    </div>
</div>
<script>
    async function fetchStatus() {
        try {
            const response = await fetch("/api/latest-status");
            const data = await response.json();

            console.log("API DATA:", data); // üîç debug

            if (data.error) {
                console.error("API Error:", data.error);
                return;
            }

            document.getElementById("vehicleId").innerText =
                data.sensor_data.vehicle_id;

            document.getElementById("healthScore").innerText =
                data.prediction.health_score;

            document.getElementById("riskLevel").innerText =
                data.prediction.risk_level;

            document.getElementById("issue").innerText =
                data.prediction.predicted_issue;

            document.getElementById("agentAction").innerText =
                data.agent_action.action;

            const riskEl = document.getElementById("riskLevel");
            riskEl.className = "";

            if (data.prediction.risk_level === "High") {
                riskEl.style.color = "red";
                riskEl.style.fontWeight = "bold";
            } else if (data.prediction.risk_level === "Medium") {
                riskEl.style.color = "orange";
                riskEl.style.fontWeight = "bold";
            } else {
                riskEl.style.color = "green";
                riskEl.style.fontWeight = "bold";
            }

        } catch (err) {
            console.error("Fetch failed:", err);
        }
    }

    fetchStatus();
    setInterval(fetchStatus, 5000);
</script>


</body>
</html>
